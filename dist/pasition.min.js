/**
 * pasition v0.2.0 By dntzhang
 * Github: https://github.com/AlloyTeam/pasition
 * MIT Licensed.
 */

!function(r,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):r.pasition=t()}(this,function(){"use strict";function r(r){var a=[];return r.replace(i,function(r,n,e){var s=n.toLowerCase();for(e=t(e),"m"==s&&e.length>2&&(a.push([n].concat(e.splice(0,2))),s="l",n="m"==n?"l":"L");;){if(e.length==c[s])return e.unshift(n),a.push(e);if(e.length<c[s])throw new Error("malformed path data");a.push([n].concat(e.splice(0,c[s])))}}),a}function t(r){var t=r.match(p);return t?t.map(Number):[]}var a=function(){function r(r,t){var a=[],n=!0,e=!1,s=void 0;try{for(var u,o=r[Symbol.iterator]();!(n=(u=o.next()).done)&&(a.push(u.value),!t||a.length!==t);n=!0);}catch(r){e=!0,s=r}finally{try{!n&&o.return&&o.return()}finally{if(e)throw s}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return r(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=2*Math.PI,e=function(r,t,a,n,e,s,u){var o=r.x,h=r.y;return o*=t,h*=a,{x:n*o-e*h+s,y:e*o+n*h+u}},s=function(r,t){var a=4/3*Math.tan(t/4),n=Math.cos(r),e=Math.sin(r),s=Math.cos(r+t),u=Math.sin(r+t);return[{x:n-e*a,y:e+n*a},{x:s+u*a,y:u-s*a},{x:s,y:u}]},u=function(r,t,a,n){var e=r*n-t*a<0?-1:1,s=Math.sqrt(r*r+t*t),u=Math.sqrt(r*r+t*t),o=r*a+t*n,h=o/(s*u);return h>1&&(h=1),h<-1&&(h=-1),e*Math.acos(h)},o=function(r,t,a,e,s,o,h,c,i,p,f,l){var y=Math.pow(s,2),v=Math.pow(o,2),x=Math.pow(f,2),g=Math.pow(l,2),M=y*v-y*g-v*x;M<0&&(M=0),M/=y*g+v*x,M=Math.sqrt(M)*(h===c?-1:1);var b=M*s/o*l,m=M*-o/s*f,d=p*b-i*m+(r+a)/2,w=i*b+p*m+(t+e)/2,k=(f-b)/s,S=(l-m)/o,A=(-f-b)/s,q=(-l-m)/o,C=u(1,0,k,S),_=u(k,S,A,q);return 0===c&&_>0&&(_-=n),1===c&&_<0&&(_+=n),[d,w,C,_]},h=function(r){var t=r.px,u=r.py,h=r.cx,c=r.cy,i=r.rx,p=r.ry,f=r.xAxisRotation,l=void 0===f?0:f,y=r.largeArcFlag,v=void 0===y?0:y,x=r.sweepFlag,g=void 0===x?0:x,M=[];if(0===i||0===p)return[];var b=Math.sin(l*n/360),m=Math.cos(l*n/360),d=m*(t-h)/2+b*(u-c)/2,w=-b*(t-h)/2+m*(u-c)/2;if(0===d&&0===w)return[];i=Math.abs(i),p=Math.abs(p);var k=Math.pow(d,2)/Math.pow(i,2)+Math.pow(w,2)/Math.pow(p,2);k>1&&(i*=Math.sqrt(k),p*=Math.sqrt(k));var S=o(t,u,h,c,i,p,v,g,b,m,d,w),A=a(S,4),q=A[0],C=A[1],_=A[2],E=A[3],F=Math.max(Math.ceil(Math.abs(E)/(n/4)),1);E/=F;for(var P=0;P<F;P++)M.push(s(_,E)),_+=E;return M.map(function(r){var t=e(r[0],i,p,m,b,q,C),a=t.x,n=t.y,s=e(r[1],i,p,m,b,q,C),u=s.x,o=s.y,h=e(r[2],i,p,m,b,q,C);return{x1:a,y1:n,x2:u,y2:o,x:h.x,y:h.y}})},c={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},i=/([astvzqmhlc])([^astvzqmhlc]*)/gi,p=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi,f={};return f.parser=r,f.lerpCurve=function(r,t,a){return a<0?a=0:a>1&&(a=1),f.lerpPoints(r[0],r[1],t[0],t[1],a).concat(f.lerpPoints(r[2],r[3],t[2],t[3],a)).concat(f.lerpPoints(r[4],r[5],t[4],t[5],a)).concat(f.lerpPoints(r[6],r[7],t[6],t[7],a))},f.lerpPoints=function(r,t,a,n,e){return[r+(a-r)*e,t+(n-t)*e]},f.q2b=function(r,t,a,n,e,s){},f.l2b=function(r,t,a,n){},f.p2b=function(r,t){},f.path2shapes=function(r){for(var t=f.parser(r),a=0,n=0,e=0,s=t.length,u=[],o=null;e<s;e++){var c=t[e],i=c[0],p=t[e-1];switch(i){case"m":var l=u.length;u[l]=[],o=u[l],a+=c[1],n+=c[2];break;case"M":var l=u.length;u[l]=[],o=u[l],a=c[1],n=c[2];break;case"l":o.push([a,n,a,n,a,n,a+c[1],n+c[2]]),a+=c[1],n+=c[2];break;case"L":o.push([a,n,c[1],c[2],c[1],c[2],c[1],c[2]]),a=c[1],n=c[2];break;case"h":o.push([a,n,a,n,a,n,a+c[1],n]),a+=c[1];break;case"H":o.push([a,n,c[1],n,c[1],n,c[1],n]),a=c[1];break;case"v":o.push([a,n,a,n,a,n,a,n+c[1]]),n+=c[1];break;case"V":o.push([a,n,a,c[1],a,c[1],a,c[1]]),n=c[1];break;case"C":o.push([a,n,c[1],c[2],c[3],c[4],c[5],c[6]]),a=c[5],n=c[6];break;case"S":"C"===p[0]?o.push([a,n,a+a-p[3],n+n-p[4],c[1],c[2],c[3],c[4]]):"c"===p[0]?o.push([a,n,a+p[5]-p[3],n+p[6]-p[4],c[1],c[2],c[3],c[4]]):"S"===p[0]?o.push([a,n,a+a-p[1],n+n-p[2],c[1],c[2],c[3],c[4]]):"s"===p[0]&&o.push([a,n,a+p[3]-p[1],n+p[4]-p[2],c[1],c[2],c[3],c[4]]),a=c[3],n=c[4];break;case"c":o.push([a,n,a+c[1],n+c[2],a+c[3],n+c[4],a+c[5],n+c[6]]),a+=c[5],n+=c[6];break;case"s":"C"===p[0]?o.push([a,n,a+a-p[3],n+n-p[4],a+c[1],n+c[2],a+c[3],n+c[4]]):"c"===p[0]?o.push([a,n,a+p[5]-p[3],n+p[6]-p[4],a+c[1],n+c[2],a+c[3],n+c[4]]):"S"===p[0]?o.push([a,n,a+p[3]-p[1],n+p[4]-p[2],a+c[1],n+c[2],a+c[3],n+c[4]]):"s"===p[0]&&o.push([a,n,a+p[3]-p[1],n+p[4]-p[2],a+c[1],n+c[2],a+c[3],n+c[4]]),a+=c[3],n+=c[4];break;case"a":var y={rx:c[1],ry:c[2],px:a,py:n,xAxisRotation:c[3],largeArcFlag:c[4],sweepFlag:c[5],cx:a+c[6],cy:a+c[7]},v=h(y),x=v[v.length-1];v.forEach(function(r,t){0===t?o.push([a,n,r.x1,r.y1,r.x2,r.y2,r.x,r.y]):o.push([v[t-1].x,v[t-1].y,r.x1,r.y1,r.x2,r.y2,r.x,r.y])}),a=x.x,n=x.y;break;case"A":var y={rx:c[1],ry:c[2],px:a,py:n,xAxisRotation:c[3],largeArcFlag:c[4],sweepFlag:c[5],cx:c[6],cy:c[7]},v=h(y),x=v[v.length-1];v.forEach(function(r,t){0===t?o.push([a,n,r.x1,r.y1,r.x2,r.y2,r.x,r.y]):o.push([v[t-1].x,v[t-1].y,r.x1,r.y1,r.x2,r.y2,r.x,r.y])}),a=x.x,n=x.y}}return u},f._upCurves=function(r,t){for(var a=0;a<t;a++)r.push(r[r.length-1].slice(0))},f._upShapes=function(r,t){for(var a=0;a<t;a++){var n=r[r.length-1],e=[];n.forEach(function(r){e.push(r.slice(0))}),r.push(e)}},f.lerp=function(r,t,a){return f._lerp(f.path2shapes(r),f.path2shapes(t),a)},f._lerp=function(r,t,a){var n=r.length,e=t.length,r=JSON.parse(JSON.stringify(r)),t=JSON.parse(JSON.stringify(t));n>e?f._upShapes(t,n-e):n<e&&f._upShapes(r,e-n),r.forEach(function(r,a){var n=r.length,e=t[a].length;n>e?f._upCurves(t[a],n-e):n<e&&f._upCurves(r,e-n)});var s=[];return r.forEach(function(r,n){var e=[];r.forEach(function(r,s){e.push(f.lerpCurve(r,t[n][s],a))}),s.push(e)}),s},f.animate=function(r,t,a,n){r=f.path2shapes(r),t=f.path2shapes(t);var e=new Date,s=n.end||function(){},u=n.progress||function(){},o=n.begin||function(){},h=n.easing||function(r){return r},c=null,i=null;o(r);!function n(){var o=new Date-e;if(o>=a)return i=t,u(i),s(i),void cancelAnimationFrame(c);i=f._lerp(r,t,h(o/a)),u(i),c=requestAnimationFrame(n)}()},f});
