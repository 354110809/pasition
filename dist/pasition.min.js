/**
 * pasition v0.3.0 By dntzhang
 * Github: https://github.com/AlloyTeam/pasition
 * MIT Licensed.
 */

!function(r,a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a():"function"==typeof define&&define.amd?define(a):r.pasition=a()}(this,function(){"use strict";function r(r){var t=[];return r.replace(i,function(r,e,n){var s=e.toLowerCase();for(n=a(n),"m"==s&&n.length>2&&(t.push([e].concat(n.splice(0,2))),s="l",e="m"==e?"l":"L");;){if(n.length==o[s])return n.unshift(e),t.push(n);if(n.length<o[s])throw new Error("malformed path data");t.push([e].concat(n.splice(0,o[s])))}}),t}function a(r){var a=r.match(p);return a?a.map(Number):[]}var t=function(){function r(r,a){var t=[],e=!0,n=!1,s=void 0;try{for(var u,c=r[Symbol.iterator]();!(e=(u=c.next()).done)&&(t.push(u.value),!a||t.length!==a);e=!0);}catch(r){n=!0,s=r}finally{try{!e&&c.return&&c.return()}finally{if(n)throw s}}return t}return function(a,t){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a))return r(a,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),e=2*Math.PI,n=function(r,a,t,e,n,s,u){var c=r.x,h=r.y;return c*=a,h*=t,{x:e*c-n*h+s,y:n*c+e*h+u}},s=function(r,a){var t=4/3*Math.tan(a/4),e=Math.cos(r),n=Math.sin(r),s=Math.cos(r+a),u=Math.sin(r+a);return[{x:e-n*t,y:n+e*t},{x:s+u*t,y:u-s*t},{x:s,y:u}]},u=function(r,a,t,e){var n=r*e-a*t<0?-1:1,s=Math.sqrt(r*r+a*a),u=Math.sqrt(r*r+a*a),c=r*t+a*e,h=c/(s*u);return h>1&&(h=1),h<-1&&(h=-1),n*Math.acos(h)},c=function(r,a,t,n,s,c,h,o,i,p,f,l){var y=Math.pow(s,2),v=Math.pow(c,2),x=Math.pow(f,2),b=Math.pow(l,2),g=y*v-y*b-v*x;g<0&&(g=0),g/=y*b+v*x,g=Math.sqrt(g)*(h===o?-1:1);var M=g*s/c*l,m=g*-c/s*f,d=p*M-i*m+(r+t)/2,w=i*M+p*m+(a+n)/2,q=(f-M)/s,k=(l-m)/c,S=(-f-M)/s,A=(-l-m)/c,C=u(1,0,q,k),_=u(q,k,S,A);return 0===o&&_>0&&(_-=e),1===o&&_<0&&(_+=e),[d,w,C,_]},h=function(r){var a=r.px,u=r.py,h=r.cx,o=r.cy,i=r.rx,p=r.ry,f=r.xAxisRotation,l=void 0===f?0:f,y=r.largeArcFlag,v=void 0===y?0:y,x=r.sweepFlag,b=void 0===x?0:x,g=[];if(0===i||0===p)return[];var M=Math.sin(l*e/360),m=Math.cos(l*e/360),d=m*(a-h)/2+M*(u-o)/2,w=-M*(a-h)/2+m*(u-o)/2;if(0===d&&0===w)return[];i=Math.abs(i),p=Math.abs(p);var q=Math.pow(d,2)/Math.pow(i,2)+Math.pow(w,2)/Math.pow(p,2);q>1&&(i*=Math.sqrt(q),p*=Math.sqrt(q));var k=c(a,u,h,o,i,p,v,b,M,m,d,w),S=t(k,4),A=S[0],C=S[1],_=S[2],E=S[3],F=Math.max(Math.ceil(Math.abs(E)/(e/4)),1);E/=F;for(var P=0;P<F;P++)g.push(s(_,E)),_+=E;return g.map(function(r){var a=n(r[0],i,p,m,M,A,C),t=a.x,e=a.y,s=n(r[1],i,p,m,M,A,C),u=s.x,c=s.y,h=n(r[2],i,p,m,M,A,C);return{x1:t,y1:e,x2:u,y2:c,x:h.x,y:h.y}})},o={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},i=/([astvzqmhlc])([^astvzqmhlc]*)/gi,p=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi,f={};return f.parser=r,f.lerpCurve=function(r,a,t){return t<0?t=0:t>1&&(t=1),f.lerpPoints(r[0],r[1],a[0],a[1],t).concat(f.lerpPoints(r[2],r[3],a[2],a[3],t)).concat(f.lerpPoints(r[4],r[5],a[4],a[5],t)).concat(f.lerpPoints(r[6],r[7],a[6],a[7],t))},f.lerpPoints=function(r,a,t,e,n){return[r+(t-r)*n,a+(e-a)*n]},f.q2b=function(r,a,t,e,n,s){return[r,a,(r+2*t)/3,(a+2*e)/3,(n+2*t)/3,(s+2*e)/3,n,s]},f.path2shapes=function(r){for(var a,t,e,n,s=f.parser(r),u=0,c=0,o=0,i=s.length,p=[],l=null;o<i;o++){var y=s[o],v=y[0],x=s[o-1];switch(v){case"m":var b=p.length;p[b]=[],l=p[b],u+=y[1],c+=y[2];break;case"M":var b=p.length;p[b]=[],l=p[b],u=y[1],c=y[2];break;case"l":l.push([u,c,u,c,u,c,u+y[1],c+y[2]]),u+=y[1],c+=y[2];break;case"L":l.push([u,c,y[1],y[2],y[1],y[2],y[1],y[2]]),u=y[1],c=y[2];break;case"h":l.push([u,c,u,c,u,c,u+y[1],c]),u+=y[1];break;case"H":l.push([u,c,y[1],c,y[1],c,y[1],c]),u=y[1];break;case"v":l.push([u,c,u,c,u,c,u,c+y[1]]),c+=y[1];break;case"V":l.push([u,c,u,y[1],u,y[1],u,y[1]]),c=y[1];break;case"C":l.push([u,c,y[1],y[2],y[3],y[4],y[5],y[6]]),u=y[5],c=y[6];break;case"S":"C"===x[0]||"c"===x[0]?l.push([u,c,u+x[5]-x[3],c+x[6]-x[4],y[1],y[2],y[3],y[4]]):"S"!==x[0]&&"s"!==x[0]||l.push([u,c,u+x[3]-x[1],c+x[4]-x[2],y[1],y[2],y[3],y[4]]),u=y[3],c=y[4];break;case"c":l.push([u,c,u+y[1],c+y[2],u+y[3],c+y[4],u+y[5],c+y[6]]),u+=y[5],c+=y[6];break;case"s":"C"===x[0]||"c"===x[0]?l.push([u,c,u+x[5]-x[3],c+x[6]-x[4],u+y[1],c+y[2],u+y[3],c+y[4]]):"S"!==x[0]&&"s"!==x[0]||l.push([u,c,u+x[3]-x[1],c+x[4]-x[2],u+y[1],c+y[2],u+y[3],c+y[4]]),u+=y[3],c+=y[4];break;case"a":var g={rx:y[1],ry:y[2],px:u,py:c,xAxisRotation:y[3],largeArcFlag:y[4],sweepFlag:y[5],cx:u+y[6],cy:u+y[7]},M=h(g),m=M[M.length-1];M.forEach(function(r,a){0===a?l.push([u,c,r.x1,r.y1,r.x2,r.y2,r.x,r.y]):l.push([M[a-1].x,M[a-1].y,r.x1,r.y1,r.x2,r.y2,r.x,r.y])}),u=m.x,c=m.y;break;case"A":var g={rx:y[1],ry:y[2],px:u,py:c,xAxisRotation:y[3],largeArcFlag:y[4],sweepFlag:y[5],cx:y[6],cy:y[7]},M=h(g),m=M[M.length-1];M.forEach(function(r,a){0===a?l.push([u,c,r.x1,r.y1,r.x2,r.y2,r.x,r.y]):l.push([M[a-1].x,M[a-1].y,r.x1,r.y1,r.x2,r.y2,r.x,r.y])}),u=m.x,c=m.y;break;case"Q":l.push(f.q2b(u,c,y[1],y[2],y[3],y[4])),u=y[3],c=y[4];break;case"q":l.push(f.q2b(u,c,u+y[1],c+y[2],y[3]+u,y[4]+c)),u+=y[3],c+=y[4];break;case"T":"Q"===x[0]||"q"===x[0]?(e=u+x[3]-x[1],n=c+x[4]-x[2],l.push(f.q2b(u,c,e,n,y[1],y[2]))):"T"!==x[0]&&"t"!==x[0]||(l.push(f.q2b(u,c,u+u-e,c+c-n,y[1],y[2])),e=u+u-e,n=c+c-n),u=y[1],c=y[2];break;case"t":"Q"===x[0]||"q"===x[0]?(e=u+x[3]-x[1],n=c+x[4]-x[2],l.push(f.q2b(u,c,e,n,u+y[1],c+y[2]))):"T"!==x[0]&&"t"!==x[0]||(l.push(f.q2b(u,c,u+u-e,c+c-n,u+y[1],c+y[2])),e=u+u-e,n=c+c-n),u+=y[1],c+=y[2];break;case"Z":case"z":a=l[0][0],t=l[0][1],l.push([u,c,a,t,a,t,a,t])}}return p},f._upCurves=function(r,a){for(var t=0;t<a;t++)r.push(r[r.length-1].slice(0))},f._upShapes=function(r,a){for(var t=0;t<a;t++){var e=r[r.length-1],n=[];e.forEach(function(r){n.push(r.slice(0))}),r.push(n)}},f.lerp=function(r,a,t){return f._lerp(f.path2shapes(r),f.path2shapes(a),t)},f._lerp=function(r,a,t){var e=r.length,n=a.length,r=JSON.parse(JSON.stringify(r)),a=JSON.parse(JSON.stringify(a));e>n?f._upShapes(a,e-n):e<n&&f._upShapes(r,n-e),r.forEach(function(r,t){var e=r.length,n=a[t].length;e>n?f._upCurves(a[t],e-n):e<n&&f._upCurves(r,n-e)});var s=[];return r.forEach(function(r,e){var n=[];r.forEach(function(r,s){n.push(f.lerpCurve(r,a[e][s],t))}),s.push(n)}),s},f.animate=function(r,a,t,e){r=f.path2shapes(r),a=f.path2shapes(a);var n=new Date,s=e.end||function(){},u=e.progress||function(){},c=e.begin||function(){},h=e.easing||function(r){return r},o=null,i=null;c(r);!function e(){var c=new Date-n;if(c>=t)return i=a,u(i),s(i),void cancelAnimationFrame(o);i=f._lerp(r,a,h(c/t)),u(i),o=requestAnimationFrame(e)}()},f});
