/**
 * pasition v0.4.0 By dntzhang
 * Github: https://github.com/AlloyTeam/pasition
 * MIT Licensed.
 */

!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):t.pasition=r()}(this,function(){"use strict";function t(t){var n=[];return t.replace(w,function(t,a,e){var s=a.toLowerCase();for(e=r(e),"m"==s&&e.length>2&&(n.push([a].concat(e.splice(0,2))),s="l",a="m"==a?"l":"L");;){if(e.length==b[s])return e.unshift(a),n.push(e);if(e.length<b[s])throw new Error("malformed path data");n.push([a].concat(e.splice(0,b[s])))}}),n}function r(t){var r=t.match(d);return r?r.map(Number):[]}function n(t){var r=t[0][0],n=t[0][1],a=r,e=n;return t.forEach(function(t){var s=t[0],u=t[2],o=t[4],h=t[6],c=t[1],i=t[3],p=t[5],f=t[7];r=Math.min(r,s,u,o,h),n=Math.min(n,c,i,p,f),a=Math.max(a,s,u,o,h),e=Math.max(e,c,i,p,f)}),[r,n,a,e]}function a(t,r){return Math.sqrt(Math.pow(t[0]-r[0],2)+Math.pow(t[1]-r[1],2))+Math.sqrt(Math.pow(t[2]-r[2],2)+Math.pow(t[3]-r[3],2))}function e(t,r){var n=t[0],a=t[2],e=t[4],s=t[6],u=t[1],o=t[3],h=t[5],c=t[7],i=r[0],p=r[2],f=r[4],l=r[6],v=r[1],x=r[3],y=r[5],M=r[7];return Math.sqrt(Math.pow(i-n,2)+Math.pow(v-u,2))+Math.sqrt(Math.pow(p-a,2)+Math.pow(x-o,2))+Math.sqrt(Math.pow(f-e,2)+Math.pow(y-h,2))+Math.sqrt(Math.pow(l-s,2)+Math.pow(M-c,2))}function s(t,r){var n=o(t.length),a=[];n.forEach(function(n){var s=0;n.forEach(function(n){s+=e(t[n],r[n])}),a.push({index:n,distance:s})}),a.sort(function(t,r){return t.distance-r.distance});var s=[];return a[0].index.forEach(function(r){s.push(t[r])}),s}function u(t,r){var e=h(t.length),s=[];e.forEach(function(e){var u=0;e.forEach(function(e){u+=a(n(t[e]),n(r[e]))}),s.push({index:e,distance:u})}),s.sort(function(t,r){return t.distance-r.distance});var u=[];return s[0].index.forEach(function(r){u.push(t[r])}),u}function o(t){for(var r=[],n=0;n<t;n++){for(var a=[],e=0;e<t;e++){var s=e+n;s>t-1&&(s-=t),a[s]=e}r.push(a)}return r}function h(t){for(var r=[],n=0;n<t;n++)r.push(n);return c(r)}function c(t){function r(t){var e,s;for(e=0;e<t.length;e++)s=t.splice(e,1)[0],a.push(s),0==t.length&&n.push(a.slice()),r(t),t.splice(e,0,s),a.pop();return n}var n=[],a=[];return r(t)}function i(t,r,n,a,e,s,u,o,h){return{left:p(t,r,n,a,e,s,u,o,h),right:p(u,o,e,s,n,a,t,r,1-h,!0)}}function p(t,r,n,a,e,s,u,o,h,c){var i=(n-t)*h+t,p=(a-r)*h+r,f=(e-n)*h+n,l=(s-a)*h+a,v=(u-e)*h+e,x=(o-s)*h+s,y=(f-i)*h+i,M=(l-p)*h+p,g=(v-f)*h+f,b=(x-l)*h+l,w=(g-y)*h+y,d=(b-M)*h+M;return c?[w,d,y,M,i,p,t,r]:[t,r,i,p,y,M,w,d]}var f=function(){function t(t,r){var n=[],a=!0,e=!1,s=void 0;try{for(var u,o=t[Symbol.iterator]();!(a=(u=o.next()).done)&&(n.push(u.value),!r||n.length!==r);a=!0);}catch(t){e=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(e)throw s}}return n}return function(r,n){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return t(r,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=2*Math.PI,v=function(t,r,n,a,e,s,u){var o=t.x,h=t.y;return o*=r,h*=n,{x:a*o-e*h+s,y:e*o+a*h+u}},x=function(t,r){var n=4/3*Math.tan(r/4),a=Math.cos(t),e=Math.sin(t),s=Math.cos(t+r),u=Math.sin(t+r);return[{x:a-e*n,y:e+a*n},{x:s+u*n,y:u-s*n},{x:s,y:u}]},y=function(t,r,n,a){var e=t*a-r*n<0?-1:1,s=Math.sqrt(t*t+r*r),u=Math.sqrt(t*t+r*r),o=t*n+r*a,h=o/(s*u);return h>1&&(h=1),h<-1&&(h=-1),e*Math.acos(h)},M=function(t,r,n,a,e,s,u,o,h,c,i,p){var f=Math.pow(e,2),v=Math.pow(s,2),x=Math.pow(i,2),M=Math.pow(p,2),g=f*v-f*M-v*x;g<0&&(g=0),g/=f*M+v*x,g=Math.sqrt(g)*(u===o?-1:1);var b=g*e/s*p,w=g*-s/e*i,d=c*b-h*w+(t+n)/2,m=h*b+c*w+(r+a)/2,q=(i-b)/e,k=(p-w)/s,E=(-i-b)/e,S=(-p-w)/s,_=y(1,0,q,k),A=y(q,k,E,S);return 0===o&&A>0&&(A-=l),1===o&&A<0&&(A+=l),[d,m,_,A]},g=function(t){var r=t.px,n=t.py,a=t.cx,e=t.cy,s=t.rx,u=t.ry,o=t.xAxisRotation,h=void 0===o?0:o,c=t.largeArcFlag,i=void 0===c?0:c,p=t.sweepFlag,y=void 0===p?0:p,g=[];if(0===s||0===u)return[];var b=Math.sin(h*l/360),w=Math.cos(h*l/360),d=w*(r-a)/2+b*(n-e)/2,m=-b*(r-a)/2+w*(n-e)/2;if(0===d&&0===m)return[];s=Math.abs(s),u=Math.abs(u);var q=Math.pow(d,2)/Math.pow(s,2)+Math.pow(m,2)/Math.pow(u,2);q>1&&(s*=Math.sqrt(q),u*=Math.sqrt(q));var k=M(r,n,a,e,s,u,i,y,b,w,d,m),E=f(k,4),S=E[0],_=E[1],A=E[2],C=E[3],F=Math.max(Math.ceil(Math.abs(C)/(l/4)),1);C/=F;for(var P=0;P<F;P++)g.push(x(A,C)),A+=C;return g.map(function(t){var r=v(t[0],s,u,w,b,S,_),n=r.x,a=r.y,e=v(t[1],s,u,w,b,S,_),o=e.x,h=e.y,c=v(t[2],s,u,w,b,S,_);return{x1:n,y1:a,x2:o,y2:h,x:c.x,y:c.y}})},b={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},w=/([astvzqmhlc])([^astvzqmhlc]*)/gi,d=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi,m={};return m.parser=t,m.lerpCurve=function(t,r,n){return n<0?n=0:n>1&&(n=1),m.lerpPoints(t[0],t[1],r[0],r[1],n).concat(m.lerpPoints(t[2],t[3],r[2],r[3],n)).concat(m.lerpPoints(t[4],t[5],r[4],r[5],n)).concat(m.lerpPoints(t[6],t[7],r[6],r[7],n))},m.lerpPoints=function(t,r,n,a,e){return[t+(n-t)*e,r+(a-r)*e]},m.q2b=function(t,r,n,a,e,s){return[t,r,(t+2*n)/3,(r+2*a)/3,(e+2*n)/3,(s+2*a)/3,e,s]},m.path2shapes=function(t){for(var r,n,a,e,s=m.parser(t),u=0,o=0,h=0,c=s.length,i=[],p=null;h<c;h++){var f=s[h],l=f[0],v=s[h-1];switch(l){case"m":var x=i.length;i[x]=[],p=i[x],u+=f[1],o+=f[2];break;case"M":var x=i.length;i[x]=[],p=i[x],u=f[1],o=f[2];break;case"l":p.push([u,o,u,o,u,o,u+f[1],o+f[2]]),u+=f[1],o+=f[2];break;case"L":p.push([u,o,f[1],f[2],f[1],f[2],f[1],f[2]]),u=f[1],o=f[2];break;case"h":p.push([u,o,u,o,u,o,u+f[1],o]),u+=f[1];break;case"H":p.push([u,o,f[1],o,f[1],o,f[1],o]),u=f[1];break;case"v":p.push([u,o,u,o,u,o,u,o+f[1]]),o+=f[1];break;case"V":p.push([u,o,u,f[1],u,f[1],u,f[1]]),o=f[1];break;case"C":p.push([u,o,f[1],f[2],f[3],f[4],f[5],f[6]]),u=f[5],o=f[6];break;case"S":"C"===v[0]||"c"===v[0]?p.push([u,o,u+v[5]-v[3],o+v[6]-v[4],f[1],f[2],f[3],f[4]]):"S"!==v[0]&&"s"!==v[0]||p.push([u,o,u+v[3]-v[1],o+v[4]-v[2],f[1],f[2],f[3],f[4]]),u=f[3],o=f[4];break;case"c":p.push([u,o,u+f[1],o+f[2],u+f[3],o+f[4],u+f[5],o+f[6]]),u+=f[5],o+=f[6];break;case"s":"C"===v[0]||"c"===v[0]?p.push([u,o,u+v[5]-v[3],o+v[6]-v[4],u+f[1],o+f[2],u+f[3],o+f[4]]):"S"!==v[0]&&"s"!==v[0]||p.push([u,o,u+v[3]-v[1],o+v[4]-v[2],u+f[1],o+f[2],u+f[3],o+f[4]]),u+=f[3],o+=f[4];break;case"a":var y={rx:f[1],ry:f[2],px:u,py:o,xAxisRotation:f[3],largeArcFlag:f[4],sweepFlag:f[5],cx:u+f[6],cy:u+f[7]},M=g(y),b=M[M.length-1];M.forEach(function(t,r){0===r?p.push([u,o,t.x1,t.y1,t.x2,t.y2,t.x,t.y]):p.push([M[r-1].x,M[r-1].y,t.x1,t.y1,t.x2,t.y2,t.x,t.y])}),u=b.x,o=b.y;break;case"A":var y={rx:f[1],ry:f[2],px:u,py:o,xAxisRotation:f[3],largeArcFlag:f[4],sweepFlag:f[5],cx:f[6],cy:f[7]},M=g(y),b=M[M.length-1];M.forEach(function(t,r){0===r?p.push([u,o,t.x1,t.y1,t.x2,t.y2,t.x,t.y]):p.push([M[r-1].x,M[r-1].y,t.x1,t.y1,t.x2,t.y2,t.x,t.y])}),u=b.x,o=b.y;break;case"Q":p.push(m.q2b(u,o,f[1],f[2],f[3],f[4])),u=f[3],o=f[4];break;case"q":p.push(m.q2b(u,o,u+f[1],o+f[2],f[3]+u,f[4]+o)),u+=f[3],o+=f[4];break;case"T":"Q"===v[0]||"q"===v[0]?(a=u+v[3]-v[1],e=o+v[4]-v[2],p.push(m.q2b(u,o,a,e,f[1],f[2]))):"T"!==v[0]&&"t"!==v[0]||(p.push(m.q2b(u,o,u+u-a,o+o-e,f[1],f[2])),a=u+u-a,e=o+o-e),u=f[1],o=f[2];break;case"t":"Q"===v[0]||"q"===v[0]?(a=u+v[3]-v[1],e=o+v[4]-v[2],p.push(m.q2b(u,o,a,e,u+f[1],o+f[2]))):"T"!==v[0]&&"t"!==v[0]||(p.push(m.q2b(u,o,u+u-a,o+o-e,u+f[1],o+f[2])),a=u+u-a,e=o+o-e),u+=f[1],o+=f[2];break;case"Z":case"z":r=p[0][0],n=p[0][1],p.push([u,o,r,n,r,n,r,n])}}return i},m._upCurves=function(t,r){for(var n=0,a=0,e=t.length;n<r;n++)t.push(t[a].slice(0)),++a>e-1&&(a-=e)},m._splitCurves=function(t,r){for(var n=0,a=0;n<r;n++){var e=t[a],s=i(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],.5);t.splice(a,1),t.splice(a,0,s.left,s.right),a+=2,a>=t.length-1&&(a=0)}},m._upShapes=function(t,r){for(var n=0;n<r;n++){var a=t[t.length-1],e=[];a.forEach(function(t){e.push(t.slice(0))}),t.push(e)}},m.lerp=function(t,r,n){return m._lerp(m.path2shapes(t),m.path2shapes(r),n)},m._preprocessing=function(t,r){var n=t.length,a=r.length,t=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(r));return n>a?m._upShapes(r,n-a):n<a&&m._upShapes(t,a-n),t=u(t,r),t.forEach(function(t,n){var a=t.length,e=r[n].length;a>e?m._splitCurves(r[n],a-e):a<e&&m._splitCurves(t,e-a)}),t.forEach(function(n,a){t[a]=s(n,r[a])}),[t,r]},m._lerp=function(t,r,n){var a=[];return t.forEach(function(t,e){var s=[];t.forEach(function(t,a){s.push(m.lerpCurve(t,r[e][a],n))}),a.push(s)}),a},m.animate=function(t,r,n,a){t=m.path2shapes(t),r=m.path2shapes(r);var e=m._preprocessing(t,r),s=new Date,u=a.end||function(){},o=a.progress||function(){},h=a.begin||function(){},c=a.easing||function(t){return t},i=null,p=null;h(t);!function t(){var a=new Date-s;if(a>=n)return p=r,o(p),u(p),void cancelAnimationFrame(i);p=m._lerp(e[0],e[1],c(a/n)),o(p),i=requestAnimationFrame(t)}()},m});
