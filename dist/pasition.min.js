/**
 * pasition v0.4.0 By dntzhang
 * Github: https://github.com/AlloyTeam/pasition
 * MIT Licensed.
 */

!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):t.pasition=r()}(this,function(){"use strict";function t(t){var n=[];return t.replace(w,function(t,a,e){var o=a.toLowerCase();for(e=r(e),"m"==o&&e.length>2&&(n.push([a].concat(e.splice(0,2))),o="l",a="m"==a?"l":"L");;){if(e.length==b[o])return e.unshift(a),n.push(e);if(e.length<b[o])throw new Error("malformed path data");n.push([a].concat(e.splice(0,b[o])))}}),n}function r(t){var r=t.match(m);return r?r.map(Number):[]}function n(t){var r=t[0][0],n=t[0][1],a=r,e=n;return t.forEach(function(t){var o=t[0],s=t[2],u=t[4],i=t[6],h=t[1],c=t[3],p=t[5],f=t[7];r=Math.min(r,o,s,u,i),n=Math.min(n,h,c,p,f),a=Math.max(a,o,s,u,i),e=Math.max(e,h,c,p,f)}),[r,n,a,e]}function a(t,r){return Math.sqrt(Math.pow(t[0]-r[0],2)+Math.pow(t[1]-r[1],2))+Math.sqrt(Math.pow(t[2]-r[2],2)+Math.pow(t[3]-r[3],2))}function e(t,r){var n=t[0],a=t[2],e=t[4],o=t[6],s=t[1],u=t[3],i=t[5],h=t[7],c=r[0],p=r[2],f=r[4],l=r[6],v=r[1],x=r[3],M=r[5],y=r[7];return Math.sqrt(Math.pow(c-n,2)+Math.pow(v-s,2))+Math.sqrt(Math.pow(p-a,2)+Math.pow(x-u,2))+Math.sqrt(Math.pow(f-e,2)+Math.pow(M-i,2))+Math.sqrt(Math.pow(l-o,2)+Math.pow(y-h,2))}function o(t,r){var n=u(t.length),a=[];n.forEach(function(n){var o=0;n.forEach(function(n){o+=e(t[n],r[n])}),a.push({index:n,distance:o})}),a.sort(function(t,r){return t.distance-r.distance});var o=[];return a[0].index.forEach(function(r){o.push(t[r])}),o}function s(t,r){var e=i(t.length),o=[];e.forEach(function(e){var s=0;e.forEach(function(e){s+=a(n(t[e]),n(r[e]))}),o.push({index:e,distance:s})}),o.sort(function(t,r){return t.distance-r.distance});var s=[];return o[0].index.forEach(function(r){s.push(t[r])}),s}function u(t){for(var r=[],n=0;n<t;n++){for(var a=[],e=0;e<t;e++){var o=e+n;o>t-1&&(o-=t),a[o]=e}r.push(a)}return r}function i(t){for(var r=[],n=0;n<t;n++)r.push(n);return h(r)}function h(t){function r(t){var e,o;for(e=0;e<t.length;e++)o=t.splice(e,1)[0],a.push(o),0==t.length&&n.push(a.slice()),r(t),t.splice(e,0,o),a.pop();return n}var n=[],a=[];return r(t)}function c(t,r,n,a,e,o,s,u,i){return{left:p(t,r,n,a,e,o,s,u,i),right:p(s,u,e,o,n,a,t,r,1-i,!0)}}function p(t,r,n,a,e,o,s,u,i,h){var c=(n-t)*i+t,p=(a-r)*i+r,f=(e-n)*i+n,l=(o-a)*i+a,v=(s-e)*i+e,x=(u-o)*i+o,M=(f-c)*i+c,y=(l-p)*i+p,g=(v-f)*i+f,d=(x-l)*i+l,b=(g-M)*i+M,w=(d-y)*i+y;return h?[b,w,M,y,c,p,t,r]:[t,r,c,p,M,y,b,w]}function f(t){var r=t.length,n=Math.round(r/2),a=t.splice(0,n);return t.unshift(a[a.length-1].slice(0)),{left:a,right:t}}var l=function(){function t(t,r){var n=[],a=!0,e=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(a=(s=u.next()).done)&&(n.push(s.value),!r||n.length!==r);a=!0);}catch(t){e=!0,o=t}finally{try{!a&&u.return&&u.return()}finally{if(e)throw o}}return n}return function(r,n){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return t(r,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),v=2*Math.PI,x=function(t,r,n,a,e,o,s){var u=t.x,i=t.y;return u*=r,i*=n,{x:a*u-e*i+o,y:e*u+a*i+s}},M=function(t,r){var n=4/3*Math.tan(r/4),a=Math.cos(t),e=Math.sin(t),o=Math.cos(t+r),s=Math.sin(t+r);return[{x:a-e*n,y:e+a*n},{x:o+s*n,y:s-o*n},{x:o,y:s}]},y=function(t,r,n,a){var e=t*a-r*n<0?-1:1,o=Math.sqrt(t*t+r*r),s=Math.sqrt(t*t+r*r),u=t*n+r*a,i=u/(o*s);return i>1&&(i=1),i<-1&&(i=-1),e*Math.acos(i)},g=function(t,r,n,a,e,o,s,u,i,h,c,p){var f=Math.pow(e,2),l=Math.pow(o,2),x=Math.pow(c,2),M=Math.pow(p,2),g=f*l-f*M-l*x;g<0&&(g=0),g/=f*M+l*x,g=Math.sqrt(g)*(s===u?-1:1);var d=g*e/o*p,b=g*-o/e*c,w=h*d-i*b+(t+n)/2,m=i*d+h*b+(r+a)/2,q=(c-d)/e,k=(p-b)/o,E=(-c-d)/e,S=(-p-b)/o,_=y(1,0,q,k),A=y(q,k,E,S);return 0===u&&A>0&&(A-=v),1===u&&A<0&&(A+=v),[w,m,_,A]},d=function(t){var r=t.px,n=t.py,a=t.cx,e=t.cy,o=t.rx,s=t.ry,u=t.xAxisRotation,i=void 0===u?0:u,h=t.largeArcFlag,c=void 0===h?0:h,p=t.sweepFlag,f=void 0===p?0:p,y=[];if(0===o||0===s)return[];var d=Math.sin(i*v/360),b=Math.cos(i*v/360),w=b*(r-a)/2+d*(n-e)/2,m=-d*(r-a)/2+b*(n-e)/2;if(0===w&&0===m)return[];o=Math.abs(o),s=Math.abs(s);var q=Math.pow(w,2)/Math.pow(o,2)+Math.pow(m,2)/Math.pow(s,2);q>1&&(o*=Math.sqrt(q),s*=Math.sqrt(q));var k=g(r,n,a,e,o,s,c,f,d,b,w,m),E=l(k,4),S=E[0],_=E[1],A=E[2],C=E[3],F=Math.max(Math.ceil(Math.abs(C)/(v/4)),1);C/=F;for(var P=0;P<F;P++)y.push(M(A,C)),A+=C;return y.map(function(t){var r=x(t[0],o,s,b,d,S,_),n=r.x,a=r.y,e=x(t[1],o,s,b,d,S,_),u=e.x,i=e.y,h=x(t[2],o,s,b,d,S,_);return{x1:n,y1:a,x2:u,y2:i,x:h.x,y:h.y}})},b={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},w=/([astvzqmhlc])([^astvzqmhlc]*)/gi,m=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi,q={};return q.parser=t,q.lerpCurve=function(t,r,n){return n<0?n=0:n>1&&(n=1),q.lerpPoints(t[0],t[1],r[0],r[1],n).concat(q.lerpPoints(t[2],t[3],r[2],r[3],n)).concat(q.lerpPoints(t[4],t[5],r[4],r[5],n)).concat(q.lerpPoints(t[6],t[7],r[6],r[7],n))},q.lerpPoints=function(t,r,n,a,e){return[t+(n-t)*e,r+(a-r)*e]},q.q2b=function(t,r,n,a,e,o){return[t,r,(t+2*n)/3,(r+2*a)/3,(e+2*n)/3,(o+2*a)/3,e,o]},q.path2shapes=function(t){for(var r=q.parser(t),n=0,a=0,e=0,o=r.length,s=[],u=null,i=void 0,h=void 0,c=void 0,p=void 0,f=void 0,l=void 0,v=void 0;e<o;e++){var x=r[e],M=x[0],y=r[e-1];switch(M){case"m":f=s.length,s[f]=[],u=s[f],n+=x[1],a+=x[2];break;case"M":f=s.length,s[f]=[],u=s[f],n=x[1],a=x[2];break;case"l":u.push([n,a,n,a,n,a,n+x[1],a+x[2]]),n+=x[1],a+=x[2];break;case"L":u.push([n,a,x[1],x[2],x[1],x[2],x[1],x[2]]),n=x[1],a=x[2];break;case"h":u.push([n,a,n,a,n,a,n+x[1],a]),n+=x[1];break;case"H":u.push([n,a,x[1],a,x[1],a,x[1],a]),n=x[1];break;case"v":u.push([n,a,n,a,n,a,n,a+x[1]]),a+=x[1];break;case"V":u.push([n,a,n,x[1],n,x[1],n,x[1]]),a=x[1];break;case"C":u.push([n,a,x[1],x[2],x[3],x[4],x[5],x[6]]),n=x[5],a=x[6];break;case"S":"C"===y[0]||"c"===y[0]?u.push([n,a,n+y[5]-y[3],a+y[6]-y[4],x[1],x[2],x[3],x[4]]):"S"!==y[0]&&"s"!==y[0]||u.push([n,a,n+y[3]-y[1],a+y[4]-y[2],x[1],x[2],x[3],x[4]]),n=x[3],a=x[4];break;case"c":u.push([n,a,n+x[1],a+x[2],n+x[3],a+x[4],n+x[5],a+x[6]]),n+=x[5],a+=x[6];break;case"s":"C"===y[0]||"c"===y[0]?u.push([n,a,n+y[5]-y[3],a+y[6]-y[4],n+x[1],a+x[2],n+x[3],a+x[4]]):"S"!==y[0]&&"s"!==y[0]||u.push([n,a,n+y[3]-y[1],a+y[4]-y[2],n+x[1],a+x[2],n+x[3],a+x[4]]),n+=x[3],a+=x[4];break;case"a":l=d({rx:x[1],ry:x[2],px:n,py:a,xAxisRotation:x[3],largeArcFlag:x[4],sweepFlag:x[5],cx:n+x[6],cy:n+x[7]}),v=l[l.length-1],l.forEach(function(t,r){0===r?u.push([n,a,t.x1,t.y1,t.x2,t.y2,t.x,t.y]):u.push([l[r-1].x,l[r-1].y,t.x1,t.y1,t.x2,t.y2,t.x,t.y])}),n=v.x,a=v.y;break;case"A":l=d({rx:x[1],ry:x[2],px:n,py:a,xAxisRotation:x[3],largeArcFlag:x[4],sweepFlag:x[5],cx:x[6],cy:x[7]}),v=l[l.length-1],l.forEach(function(t,r){0===r?u.push([n,a,t.x1,t.y1,t.x2,t.y2,t.x,t.y]):u.push([l[r-1].x,l[r-1].y,t.x1,t.y1,t.x2,t.y2,t.x,t.y])}),n=v.x,a=v.y;break;case"Q":u.push(q.q2b(n,a,x[1],x[2],x[3],x[4])),n=x[3],a=x[4];break;case"q":u.push(q.q2b(n,a,n+x[1],a+x[2],x[3]+n,x[4]+a)),n+=x[3],a+=x[4];break;case"T":"Q"===y[0]||"q"===y[0]?(c=n+y[3]-y[1],p=a+y[4]-y[2],u.push(q.q2b(n,a,c,p,x[1],x[2]))):"T"!==y[0]&&"t"!==y[0]||(u.push(q.q2b(n,a,n+n-c,a+a-p,x[1],x[2])),c=n+n-c,p=a+a-p),n=x[1],a=x[2];break;case"t":"Q"===y[0]||"q"===y[0]?(c=n+y[3]-y[1],p=a+y[4]-y[2],u.push(q.q2b(n,a,c,p,n+x[1],a+x[2]))):"T"!==y[0]&&"t"!==y[0]||(u.push(q.q2b(n,a,n+n-c,a+a-p,n+x[1],a+x[2])),c=n+n-c,p=a+a-p),n+=x[1],a+=x[2];break;case"Z":case"z":i=u[0][0],h=u[0][1],u.push([n,a,i,h,i,h,i,h])}}return s},q._upCurves=function(t,r){for(var n=0,a=0,e=t.length;n<r;n++)t.push(t[a].slice(0)),++a>e-1&&(a-=e)},q._splitCurves=function(t,r){for(var n=0,a=0;n<r;n++){var e=t[a],o=c(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],.5);t.splice(a,1),t.splice(a,0,o.left,o.right),a+=2,a>=t.length-1&&(a=0)}},q._splitShapes=function(t,r){for(var n=0,a=0;a<r;a++){var e=f(t[n]);t.splice(n,1),t.splice(n,0,e.left,e.right),n+=2,n>=t.length-1&&(n=0)}},q._upShapes=function(t,r){for(var n=0;n<r;n++)!function(r){var n=t[t.length-1],a=[];n.forEach(function(t){a.push(t.slice(0))}),t.push(a)}()},q.lerp=function(t,r,n){return q._lerp(q.path2shapes(t),q.path2shapes(r),n)},q._preprocessing=function(t,r){var n=t.length,a=r.length,e=JSON.parse(JSON.stringify(t)),u=JSON.parse(JSON.stringify(r));return n>a?q._upShapes(u,n-a):n<a&&q._upShapes(e,a-n),e=s(e,u),e.forEach(function(t,r){var n=t.length,a=u[r].length;n>a?q._splitCurves(u[r],n-a):n<a&&q._splitCurves(t,a-n)}),e.forEach(function(t,r){e[r]=o(t,u[r])}),[e,u]},q._lerp=function(t,r,n){var a=[];return t.forEach(function(t,e){var o=[];t.forEach(function(t,a){o.push(q.lerpCurve(t,r[e][a],n))}),a.push(o)}),a},q.animate=function(t,r,n,a){t=q.path2shapes(t),r=q.path2shapes(r);var e=q._preprocessing(t,r),o=new Date,s=a.end||function(){},u=a.progress||function(){},i=a.begin||function(){},h=a.easing||function(t){return t},c=null,p=null;i(t);!function t(){var a=new Date-o;if(a>=n)return p=r,u(p),s(p),void cancelAnimationFrame(c);p=q._lerp(e[0],e[1],h(a/n)),u(p),c=requestAnimationFrame(t)}()},q});
